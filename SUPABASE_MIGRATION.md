# üöÄ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Supabase

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω —Å —Ñ–∞–π–ª–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ **Supabase (PostgreSQL)**!

## ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –£–¥–∞–ª–µ–Ω–æ:

- ‚ùå –õ–æ–∫–∞–ª—å–Ω—ã–µ JSON —Ñ–∞–π–ª—ã (`stands.json`, `users.json`)
- ‚ùå –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—É—Ç—è–º–∏ –≤ production —Ä–µ–∂–∏–º–µ
- ‚ùå –°—Ç–∞—Ä—ã–µ API endpoints:
  - `/api/login.post.js`
  - `/api/register.post.js`
  - `/api/stands.get.js`
  - `/api/stands.post.js`
  - `/api/reset.post.js`
  - `/api/user.get.js`

### –î–æ–±–∞–≤–ª–µ–Ω–æ:

- ‚úÖ **Supabase** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PostgreSQL
- ‚úÖ –ù–æ–≤—ã–µ API endpoints:
  - `/api/auth/login` - –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `/api/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `/api/stands` (GET) - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–µ–Ω–¥–æ–≤
  - `/api/stands` (POST) - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–µ–Ω–¥–∞
  - `/api/stands/reset` - —Å–±—Ä–æ—Å –≤—Å–µ—Ö —Å—Ç–µ–Ω–¥–æ–≤
- ‚úÖ Composable `useSupabase.js` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Health Check –¥–ª—è Supabase

## üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ Supabase

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [supabase.com](https://supabase.com)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (~2 –º–∏–Ω—É—Ç—ã)

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞

1. –í –ø–∞–Ω–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞: **Settings** ‚Üí **API**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - **Project URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://abc123.supabase.co`)
   - **Anon public key** (–¥–ª–∏–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω)

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Editor** –≤ Supabase –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE users (
  id BIGSERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–µ–Ω–¥–æ–≤
CREATE TABLE stands (
  id BIGSERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  type VARCHAR(50) NOT NULL, -- 'frontend' –∏–ª–∏ 'backend'
  status VARCHAR(50) DEFAULT 'free', -- 'free' –∏–ª–∏ 'occupied'
  occupied_by VARCHAR(255),
  occupied_at TIMESTAMP WITH TIME ZONE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
CREATE INDEX idx_stands_type ON stands(type);
CREATE INDEX idx_stands_status ON stands(status);
CREATE INDEX idx_users_email ON users(email);

-- –í–∫–ª—é—á–µ–Ω–∏–µ Row Level Security (RLS)
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE stands ENABLE ROW LEVEL SECURITY;

-- –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ (—Ä–∞–∑—Ä–µ—à–∞–µ–º –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
CREATE POLICY "Allow all operations" ON users FOR ALL USING (true);
CREATE POLICY "Allow all operations" ON stands FOR ALL USING (true);
```

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### API Endpoints

**–°—Ç–∞—Ä—ã–µ** ‚Üí **–ù–æ–≤—ã–µ**:

- `POST /api/login` ‚Üí `POST /api/auth/login`
- `POST /api/register` ‚Üí `POST /api/auth/register`
- `GET /api/stands` ‚Üí `GET /api/stands` (—Ä–∞–±–æ—Ç–∞–µ—Ç)
- `POST /api/stands` ‚Üí `POST /api/stands` (–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)
- `POST /api/reset` ‚Üí `POST /api/stands/reset`

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

**–°—Ç–µ–Ω–¥—ã (–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)**:

```json
{
  "id": 1,
  "name": "deploy_loadtest",
  "type": "frontend",
  "status": "occupied",
  "occupied_by": "user@example.com",
  "occupied_at": "2024-07-15T10:30:00Z"
}
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–µ–Ω–¥–∞**:

```json
{
  "standId": 1,
  "action": "occupy", // –∏–ª–∏ "release"
  "user": {
    "id": 123,
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "email": "ivan@example.com"
  }
}
```

### –ö–æ–º–ø–æ–∑–∞–±–ª—ã

- ‚úÖ `useSupabase()` - –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–∑–∞–±–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- ‚úÖ `useApi()` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –Ω–æ–≤—ã—Ö endpoints
- ‚úÖ `useUser()` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –Ω–æ–≤–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ `useStands()` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Supabase

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ Supabase

–ï—Å–ª–∏ –≤—ã –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ Supabase, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –Ω–æ –Ω–µ –ø–∞–¥–∞—Ç—å.

### –° –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º Supabase

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –∫–ª—é—á–∞–º–∏
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: `npm run dev`
3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Å—Ç–µ–Ω–¥—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
‚îú‚îÄ‚îÄ composables/
‚îÇ   ‚îú‚îÄ‚îÄ useSupabase.js      # ‚úÖ –ù–æ–≤—ã–π - —Ä–∞–±–æ—Ç–∞ —Å Supabase
‚îÇ   ‚îú‚îÄ‚îÄ useApi.js           # ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω - –Ω–æ–≤—ã–µ endpoints
‚îÇ   ‚îú‚îÄ‚îÄ useUser.js          # ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω - –Ω–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ useStands.js        # ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω - —Ä–∞–±–æ—Ç–∞ —Å Supabase
‚îú‚îÄ‚îÄ server/api/
‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.post.js   # ‚úÖ –ù–æ–≤—ã–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ register.post.js # ‚úÖ –ù–æ–≤—ã–π
‚îÇ   ‚îú‚îÄ‚îÄ stands/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.get.js    # ‚úÖ –ù–æ–≤—ã–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.post.js   # ‚úÖ –ù–æ–≤—ã–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reset.post.js   # ‚úÖ –ù–æ–≤—ã–π
‚îÇ   ‚îî‚îÄ‚îÄ health.get.js       # ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è Supabase
‚îî‚îÄ‚îÄ supabase-setup.md       # ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: PostgreSQL –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
2. **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ Row Level Security
3. **üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
4. **üåê Production-ready**: –ù–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å –ø—É—Ç—è–º–∏ –∫ —Ñ–∞–π–ª–∞–º
5. **üîß –ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–µ–ø–ª–æ—è**: –û–¥–∏–Ω —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–æ–∏–ª - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ
6. **üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ Supabase
7. **üîÑ Backup**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üö¶ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Supabase –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
